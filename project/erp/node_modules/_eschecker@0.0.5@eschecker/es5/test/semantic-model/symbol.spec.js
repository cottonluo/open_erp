"use strict";

var _chai = require("chai");

var _symbol = require("../../lib/semantic-model/symbol");

var _symbol2 = _interopRequireDefault(_symbol);

var _numberType = require("../../lib/semantic-model/types/number-type");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

describe("Symbol", function () {
	it("has no members by default", function () {
		// arrange
		const symbol = new _symbol2.default("x", _symbol.SymbolFlags.BlockScopedVariable | _symbol.SymbolFlags.Variable);

		// assert
		(0, _chai.expect)(Array.from(symbol.members.values())).to.be.empty;
	});

	it("initializes the declaration and value declaration to null by default", function () {
		// arrange
		const symbol = new _symbol2.default("x", _symbol.SymbolFlags.BlockScopedVariable | _symbol.SymbolFlags.Variable);

		// assert
		(0, _chai.expect)(symbol).to.have.property("declaration").that.is.null;
		(0, _chai.expect)(symbol).to.have.property("valueDeclaration").that.is.null;
	});

	it("sets the name and flags to the constructor arguments", function () {
		// arrange
		const symbol = new _symbol2.default("x", _symbol.SymbolFlags.BlockScopedVariable | _symbol.SymbolFlags.Variable);

		// assert
		(0, _chai.expect)(symbol).to.have.property("name").that.equals("x");
		(0, _chai.expect)(symbol).to.have.property("flags").that.equals(_symbol.SymbolFlags.BlockScopedVariable | _symbol.SymbolFlags.Variable);
	});

	describe("addMember", function () {
		it("adds the given member tot he symbol's members", function () {
			// arrange
			const symbol = new _symbol2.default("person", _symbol.SymbolFlags.BlockScopedVariable | _symbol.SymbolFlags.Variable);
			const memberSymbol = new _symbol2.default("name", _symbol.SymbolFlags.Property);

			// act
			symbol.addMember(memberSymbol);

			// assert
			(0, _chai.expect)(symbol.getMember("name")).to.equal(memberSymbol);
		});

		it("throws if the symbol already has a member with the given name", function () {
			// arrange
			const symbol = new _symbol2.default("person", _symbol.SymbolFlags.BlockScopedVariable | _symbol.SymbolFlags.Variable);
			const memberSymbol = new _symbol2.default("name", _symbol.SymbolFlags.Property);
			symbol.addMember(memberSymbol);

			// act
			(0, _chai.expect)(() => symbol.addMember(memberSymbol)).to.throw;
		});

		it("throws if the symbol is absent", function () {
			// arrange
			const symbol = new _symbol2.default("person", _symbol.SymbolFlags.BlockScopedVariable | _symbol.SymbolFlags.Variable);

			// act
			(0, _chai.expect)(() => symbol.addMember()).to.throw;
		});
	});

	describe("hasMember", function () {
		it("returns false if the symbol has no member with the given name", function () {
			// arrange
			const symbol = new _symbol2.default("person", _symbol.SymbolFlags.BlockScopedVariable | _symbol.SymbolFlags.Variable);
			const memberSymbol = new _symbol2.default("name", _symbol.SymbolFlags.Property);
			symbol.addMember(memberSymbol);

			// act, assert
			(0, _chai.expect)(symbol.hasMember("age")).to.be.false;
		});

		it("returns true if the symbol has a member with the given name", function () {
			// arrange
			const symbol = new _symbol2.default("person", _symbol.SymbolFlags.BlockScopedVariable | _symbol.SymbolFlags.Variable);
			const memberSymbol = new _symbol2.default("name", _symbol.SymbolFlags.Property);
			symbol.addMember(memberSymbol);

			// act, assert
			(0, _chai.expect)(symbol.hasMember("name")).to.be.true;
		});
	});

	describe("toString", function () {
		it("returns the name of the symbol", function () {
			// arrange
			const symbol = new _symbol2.default("x", _symbol.SymbolFlags.BlockScopedVariable);
			symbol.type = _numberType.NumberType.create();

			// act, assert
			(0, _chai.expect)(symbol.toString()).to.equal("x");
		});
	});
});
//# sourceMappingURL=symbol.spec.js.map
